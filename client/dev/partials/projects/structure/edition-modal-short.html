<div class="modal-body">
	<form class="form-horizontal" role="form" name="planningForm" novalidate>
		<legend>{{indicator.name[language]}}</legend>

		<div class="form-group">
			<label for="formula-input" class="col-sm-2 control-label" translate="project.formula"></label>
			<div class="col-sm-10" acl-has-project-role="owner" acl-fallback="planning.formula">
				<input expression id="colorize-input" class="form-control" ng-model="planning.formula" />
			</div>
		</div>

		<table class="table table-bordered table-condensed table-stripped">
			<thead>
				<tr>
					<th style="width: 15%" translate="project.parameter"></th>
					<th style="width: 30%" translate="project.variable"></th>
					<th style="width: 55%" translate="project.filters"></th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="(key, parameter) in planning.parameters">
					<!-- parameter key (this one we edit in the formula) -->
					<td>{{key}}</td>

					<!-- elementId -->
					<td>
						<select required
								class="form-control"
								ng-model="parameter.elementId"
								ng-options="v.id as v.name group by v.group for v in selectElements"></select>
					</td>
					<td>
						<div class="row" ng-repeat="partition in elementsById[parameter.elementId].partitions" style="margin-bottom: 3px">
							<div class="col-sm-2">
								<div style="margin: 4px">
									<strong>{{partition.name}}</strong>
								</div>
							</div>
							<div class="col-sm-10">
								<partition-filter ng-model="parameter.filter[partition.id]" partition="partition"></partition-filter>
							</div>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</form>
</div>

<div class="modal-footer">
	<button ng-click="save()" ng-disabled="planningForm.$invalid" class="btn btn-primary" acl-has-project-role="owner">
		<i class="fa fa-object-group"></i>
		<span translate="project.update_logframe"></span>
	</button>

	<button ng-click="delete()" class="btn btn-danger" ng-if="!isNew" acl-has-project-role="owner">
		<i class="fa fa-remove"></i>
		<span translate="shared.delete"></span>
	</button>

	<button ng-click="cancel()" class="btn btn-default">
		<i class="fa fa-undo"></i>
		<span translate="shared.cancel"></span>
	</button>
</div>
