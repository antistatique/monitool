<ol class="breadcrumb">
	<li><a ui-sref="main.indicators" translate="shared.indicators"></a></li>
	<li class="active">{{indicator.name[language]}}</li>
</ol>

<form class="form-horizontal" role="form" name="indicatorForm" novalidate>

	<table class="table table-stripped table-condensed table-bordered">
		<thead>
			<tr>
				<th style="width: 10%"></th>
				<th ng-repeat="(code, language) in languages" translate="{{'menu.' + language}}" style="width: 30%"></th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<th translate="indicator.themes"></th>
				<td colspan="{{numLanguages}}">
					<ui-select id="input-themes" multiple ng-model="indicator.themes" name="themes" theme="bootstrap" required acl-has-role="indicator">
						<ui-select-match placeholder="{{'indicator.select_themes'|translate}}">{{$item.name[language]}}</ui-select-match>
						<ui-select-choices repeat="theme._id as theme in themes">{{theme.name[language]}}</ui-select-choices>
					</ui-select>

					<p class="form-control-static" acl-lacks-role="indicator">{{indicator.themes|getObjects:themes|pluck:'name'|pluck:language|join:', '}}</p>
				</td>
			</tr>			
			<tr ng-repeat="field in ['name', 'standard', 'sources', 'comments']">
				<th>{{('indicator.'+field)|translate}}</th>
				<td ng-repeat="(code, language) in languages" acl-has-role="indicator" acl-fallback="indicator[field][code]|nl2br">
					<div class="input-group">
 						<textarea auto-resize
 								  class="form-control"
								  name="{{field + '.' + code}}"
								  ng-required="field == 'name'"
								  ng-model="indicator[field][code]"
								  placeholder="{{translations[code].indicator[field + '_ph']}}"></textarea>

						<span class="input-group-addon">
							<div dropdown>
								<span id="single-button" dropdown-toggle>
									<i class="fa fa-language"></i>
								</span>

								<ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="single-button">
									<li ng-class="{disabled:!indicator[field][codeInner]}" role="menuitem" ng-repeat="(codeInner, languageInner) in languages" ng-if="code != codeInner">
										<a ng-click="translate(field, code, codeInner)">{{('indicator.translate_from_' + codeInner)|translate}}</a>
									</li>
								</ul>
							</div>
						</span>
					</div>
				</td>
			</tr>


			<tr>
				<th translate="indicator.target"></th>
				<td colspan="{{numLanguages}}" acl-has-role="indicator" acl-fallback="('indicator.' + indicator.targetType)|translate">

					<select id="input-target" class="form-control" ng-model="indicator.targetType" required>
						<option value="lower_is_better" translate="indicator.lower_is_better"></option>
						<option value="higher_is_better" translate="indicator.higher_is_better"></option>
						<option value="around_is_better" translate="indicator.around_is_better"></option>
						<option value="non_relevant" translate="indicator.non_relevant"></option>
					</select>
				</td>
			</tr>

			<tr>
				<th translate="indicator.unit"></th>
				<td colspan="{{numLanguages}}" acl-has-role="indicator" acl-fallback="('indicator.' + indicator.unit)|translate">

					<select id="input-unit" name="unit" ng-model="planning.unit" class="form-control" required>
						<option value="none" translate="indicator.other"></option>
						<option value="%" translate="indicator.percent"></option>
						<option value="â€°" translate="indicator.permille"></option>
					</select>

				</td>
			</tr>
			
		</tbody>
	</table>

	<div acl-has-role="indicator" class="noprint" style="margin-bottom: 20px">
		<a ng-disabled="!indicatorSavable || indicatorSaveRunning" class="btn btn-primary" ng-click="save()">
			<i class="fa fa-floppy-o" ng-if="!indicatorSaveRunning"></i>
			<i class="fa fa-circle-o-notch fa-spin" ng-if="indicatorSaveRunning"></i>

			<span translate="shared.save"></span>
		</a>

		<a ng-click="reset()" ng-disabled="!indicatorChanged || indicatorSaveRunning" class="btn btn-default">
			<i class="fa fa-undo"></i>
			<span translate="shared.remove_changes"></span>
		</a>

		<a class="btn btn-danger" ng-if="indicator._rev" ng-click="delete()">
			<i class="fa fa-trash"></i>
			<span translate="shared.delete"></span>
		</a> 
	</div>
</form>
